<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Kings Cross Hospitality Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f7;
      margin: 0;
      padding: 20px;
      color: #222;
    }
    h1 {
      text-align: center;
      margin-bottom: 25px;
      font-size: 28px;
    }
    .card {
      background: white;
      padding: 20px;
      border-radius: 14px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.12);
    }
    h2 {
      margin-top: 0;
      border-left: 4px solid #f97316;
      padding-left: 8px;
      color: #333;
    }
    ul {
      padding: 0;
      margin: 0;
      list-style: none;
    }
    li {
      padding: 6px 0;
      border-bottom: 1px solid #eee;
    }
  </style>
</head>

<body>

<h1> Kings Cross Hospitality Dashboard </h1>

<div class="card">
  <h2>Weather</h2>
  <p id="weather-info">Loading...</p>
</div>

<div class="card">
  <h2>Transport Status</h2>
  <ul id="transport-list"></ul>
</div>

<div class="card">
  <h2>Upcoming Events</h2>
  <ul id="events-list"></ul>
</div>

<div class="card">
  <h2>Restaurants & Places</h2>
  <ul id="places-list"></ul>
</div>

<div class="card">
  <h2>Local News</h2>
  <ul id="news-list"></ul>
</div>

<script>
async function loadJSON(path) {
  try {
    const r = await fetch(path + "?v=" + Date.now());
    if (!r.ok) throw new Error("Missing");
    return await r.json();
  } catch (e) {
    return null;
  }
}

// WEATHER → correct path: data/kingscross_weather.json
loadJSON("data/kingscross_weather.json").then(weather => {
  const el = document.getElementById("weather-info");
  if (!weather || !weather.temperature_C) {
    el.textContent = "Weather unavailable";
    return;
  }
  el.textContent = `${weather.temperature_C}°C, Wind ${weather.windspeed_kmh} km/h`;
});

// TFL → correct: data/kingscross_tfl.json
loadJSON("data/kingscross_tfl.json").then(tfl => {
  const list = document.getElementById("transport-list");
  if (!tfl) {
    list.innerHTML = "<li>No transport data</li>";
    return;
  }
  Object.keys(tfl).forEach(name => {
    const info = tfl[name];
    list.innerHTML += `<li><b>${name}</b> (${info.mode}): ${info.status}</li>`;
  });
});

// EVENTS → correct file: data/events.json
loadJSON("data/events.json").then(events => {
  const list = document.getElementById("events-list");
  if (!events || events.length === 0) {
    list.innerHTML = "<li>No upcoming events</li>";
    return;
  }
  events.forEach(ev => {
    list.innerHTML += `
      <li><b>${ev.name}</b> — ${ev.start}<br>
      <a href="${ev.url}" target="_blank">View event</a></li>`;
  });
});

// PLACES → correct file: data/places_reviews.json
loadJSON("data/places_reviews.json").then(places => {
  const list = document.getElementById("places-list");
  if (!places || places.length === 0) {
    list.innerHTML = "<li>No places data</li>";
    return;
  }
  places.forEach(p => {
    list.innerHTML += `
      <li><b>${p.name}</b> — ${p.rating}★ <br>
      <small>${p.address}</small></li>`;
  });
});

// NEWS → correct file: data/news.json
loadJSON("data/news.json").then(news => {
  const list = document.getElementById("news-list");
  if (!news || news.length === 0) {
    list.innerHTML = "<li>No news available</li>";
    return;
  }
  news.forEach(n => {
    list.innerHTML += `<li><a href="${n.url}" target="_blank">${n.title}</a></li>`;
  });
});
</script>

</body>
</html>
