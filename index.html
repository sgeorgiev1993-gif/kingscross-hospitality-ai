<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kings Cross Live Dashboard</title>
<style>
  body { font-family: Arial, sans-serif; background:#f9f9f9; margin:0; padding:20px; }
  h1,h2 { text-align:center; color:#333; }
  .dashboard { display:grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap:20px; margin-top:20px; }
  .card { background:#fff; padding:15px 20px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
  .card h3 { margin:0 0 10px 0; font-size:1.1em; }
  .card p { margin:5px 0; font-size:0.95em; }
  .status { font-weight:bold; padding:2px 6px; border-radius:6px; color:#fff; }
  .Good\ Service { background:green; }
  .Minor\ Delays { background:orange; }
  .Severe\ Delays { background:red; }
  .Part\ Closure { background:purple; }
  .Planned\ Closure { background:gray; }
  .Service\ Closed { background:black; }
  .events ul { list-style:none; padding:0; }
  .events li { margin-bottom:10px; }
  .events a { text-decoration:none; color:#007bff; font-weight:600; }
  .events a:hover { text-decoration:underline; }
  button { margin:20px 0; padding:10px 20px; font-size:1em; cursor:pointer; border-radius:8px; border:none; background:#007bff; color:#fff; }
  button:hover { background:#0056b3; }
</style>
</head>
<body>
<h1>ğŸ™ï¸ Kings Cross Live Dashboard</h1>
<p style="text-align:center;">Updated automatically every hour</p>
<button onclick="refreshPage()">ğŸ”„ Refresh Now</button>

<h2>ğŸŒ¡ï¸ Current Temperature</h2>
<div class="dashboard">
  <div class="card" id="temperatureCard">
    <h3>Temperature</h3>
    <p id="tempValue">Loading...</p>
    <p id="windValue"></p>
  </div>
</div>

<h2>ğŸš‡ TfL Line Status</h2>
<div class="dashboard" id="tflDashboard">
  <p>Loading TfL status...</p>
</div>

<h2>ğŸ« Upcoming Events in Kingâ€™s Cross</h2>
<div class="dashboard events" id="eventDashboard">
  <p>Loading events...</p>
</div>

<footer style="text-align:center; margin-top:40px; font-size:0.85em; color:#777;">
  Data sources: OpenWeather, TfL, Eventbrite | Dashboard generated with Python & GitHub Actions
</footer>

<script>
function refreshPage() { location.reload(); }

// Load dashboard JSON
fetch('data/kingscross_dashboard.json')
  .then(r => r.json())
  .then(data => {
    // Temperature
    document.getElementById('tempValue').innerText = `${data.weather.temperature_C}Â°C`;
    document.getElementById('windValue').innerText = `Wind: ${data.weather.windspeed_kmh} km/h`;

    // TfL lines
    const tflDiv = document.getElementById('tflDashboard');
    tflDiv.innerHTML = '';
    data.tfl.forEach(line => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `<h3>${line.name} (${line.mode})</h3><p>Status: <span class="status ${line.status.replace(/ /g,'\\ ')}">${line.status}</span></p>`;
      tflDiv.appendChild(card);
    });
  })
  .catch(err => console.error(err));

// Load events
fetch('data/events.json')
  .then(r => r.json())
  .then(events => {
    const eventsDiv = document.getElementById('eventDashboard');
    eventsDiv.innerHTML = '';
    if(events.length === 0) {
      eventsDiv.innerHTML = '<p>No upcoming events found.</p>';
    } else {
      events.slice(0,10).forEach(ev => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `<h3><a href="${ev.url}" target="_blank">${ev.name}</a></h3><p>${new Date(ev.start).toLocaleString()}</p>`;
        eventsDiv.appendChild(card);
      });
    }
  })
  .catch(err => console.error(err));

// Auto-refresh every hour
setTimeout(refreshPage, 3600000);
</script>
</body>
</html>